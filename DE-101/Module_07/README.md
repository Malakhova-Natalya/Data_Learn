# üóÇÔ∏è –ú–æ–¥—É–ª—å 07: 
–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª—ã –º–æ–¥—É–ª—è: [–∑–¥–µ—Å—å](https://github.com/Data-Learn/data-engineering/tree/master/DE-101%20Modules/Module07 "–∑–¥–µ—Å—å") üìë


–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª—ã –∫ –≤–µ–±–∏–Ω–∞—Ä—É "–í–≤–µ–¥–µ–Ω–∏–µ –≤ PySpark –∏ SparkSQL" (–û–ª–µ–≥ –ê–≥–∞–ø–æ–≤): [–∑–¥–µ—Å—å](https://github.com/oleg-agapov/getting-started-with-pyspark-ru "–∑–¥–µ—Å—å") üìë

‚úíÔ∏è **–ó–∞–¥–∞—á–∏:** 
- **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ –∏–∑—É—á–∏—Ç—å –æ—Å–Ω–æ–≤—ã Apache Spark**
- **–ù–∞–ª–∞–¥–∏—Ç—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å Jupyter Notebook**
- **–í—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞–¥–∞–Ω–∏—è –¥–ª—è –ø—Ä–∞–∫—Ç–∏–∫–∏, –∏—Å–ø–æ–ª—å–∑—É—è —Ä–∞–∑–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ Spark**

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Apache Spark

**1. –î–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ —Å–∞–π—Ç**: https://spark.apache.org/downloads.html


–ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–∫—Ç—É–ª–∞—å–Ω–æ—Å—Ç—å –≤–µ—Ä—Å–∏–∏ –∏ **–Ω–∞–∂–∏–º–∞–µ–º –Ω–∞ –ø—É–Ω–∫—Ç Download Spark**:
![cover](https://github.com/Malakhova-Natalya/Data_Learn/blob/main/DE-101/Module_07/download%20start.png)


**2**. –ü–æ–ø–∞–¥–∞–µ–º —Å—é–¥–∞: https://www.apache.org/dyn/closer.lua/spark/spark-3.5.0/spark-3.5.0-bin-hadoop3.tgz


**–ó–∞–≥—Ä—É–∂–∞–µ–º –∞—Ä—Ö–∏–≤** –ø–æ –≤–µ—Ä—Ö–Ω–µ–π —Å—Å—ã–ª–∫–µ:
![cover](https://github.com/Malakhova-Natalya/Data_Learn/blob/main/DE-101/Module_07/download%20apache%20spark.png)


**3**. –í IDE - –Ω–∞–ø—Ä–∏–º–µ—Ä, Visual Studio Code - –æ—Ç–∫—Ä—ã–≤–∞–µ–º –Ω–æ–≤—ã–π —Ç–µ—Ä–º–∏–Ω–∞–ª powershell –∏ **–≤—ã–ø–æ–ª–Ω—è–µ–º –∫–æ–º–∞–Ω–¥—É, —á—Ç–æ–±—ã —Ä–∞—Å–ø–∞–∫–æ–≤–∞—Ç—å —Å–∫–∞—á–∞–Ω–Ω—ã–π –∞—Ä—Ö–∏–≤**:


   tar - xvzf [–ø–æ–ª–Ω—ã–π –ø—É—Ç—å –¥–æ —Å–∫–∞—á–∞–Ω–Ω–æ–≥–æ –∞—Ä—Ö–∏–≤–∞] -C [–ø—É—Ç—å –∫—É–¥–∞ —Ä–∞—Å–ø–∞–∫–æ–≤–∞—Ç—å]

   
   –ü—Ä–∏–º–µ—Ä:    tar - xvzf C:\Users\Natalya_PY\Downloads\spark-3.5.0-bin-hadoop3.tgz -C C:\Users\Natalya_PY\Downloads


–≠—Ç–æ –º—ã —Ç–∞–∫ —Ä–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ–º –∞—Ä—Ö–∏–≤ –≤ –Ω–µ–æ–±—ã—á–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ (–ø–æ—Ç–æ–º—É —á—Ç–æ Windows –µ–≥–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å–ø–∞–∫–æ–≤–∞—Ç—å –Ω–µ –º–æ–∂–µ—Ç)

**4**. –î–∞–ª–µ–µ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –ø–∞–ø–∫—É —Å —Ä–∞—Å–ø–∞–∫–æ–≤–∞–Ω–Ω—ã–º –∞—Ä—Ö–∏–≤–æ–º –∫—É–¥–∞ –ø–æ–∂–µ–ª–∞–µ—Ç–µ (—è, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–¥–µ–ª–∞–ª–∞ —Å–µ–±–µ –æ—Ç–¥–µ–ª—å–Ω—É—é –ø–∞–ø–∫—É spark).

–ï—Å—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, —á—Ç–æ –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –∑–∞–ø—É—Å–∫–∞ –µ—â—ë –Ω—É–∂–µ–Ω **—Ñ–∞–π–ª winutils.exe**. –°–∫–∞—á–∞—Ç—å –µ–≥–æ –º–æ–∂–Ω–æ –∑–¥–µ—Å—å: https://github.com/cdarlint/winutils (–∏–∑ –ø–∞–ø–∫–∏ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–µ–π hadoop, –Ω–∞–ø—Ä–∏–º–µ—Ä —Å–µ–π—á–∞—Å —ç—Ç–æ hadoop-3.3.5/bin). –î–∞–ª–µ–µ —è —Å–æ–∑–¥–∞–ª–∞ –ø–∞–ø–∫–∏ Hadoop –∏ –≤–Ω—É—Ç—Ä–∏ –Ω–µ—ë –ø–∞–ø–∫—É bin, –∫—É–¥–∞ –ø–æ–º–µ—Å—Ç–∏–ª–∞ —Ñ–∞–π–ª winutils, –ø–æ–ª—É—á–∏–ª–æ—Å—å: C:\Program Files\Hadoop\bin\winutils.


–¢–∞–∫–∂–µ –Ω—É–∂–Ω–æ –ø—Ä–æ–ø–∏—Å–∞—Ç—å **–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å—Ä–µ–¥—ã –Ω–∞ Windows**. –ü–æ–∏—Å–∫ - –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω–Ω—ã—Ö —Å—Ä–µ–¥—ã - –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å—Ä–µ–¥—ã - –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å—Ä–µ–¥—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è - –°–æ–∑–¥–∞—Ç—å.


–ù–∞–ø—Ä–∏–º–µ—Ä, —É –º–µ–Ω—è —ç—Ç–æ:
- JAVA_HOME: C:\Program Files\Java\jre1.8.0_261
- HADOOP_HOME: C:\Program Files\Hadoop
- SPARK_HOME: C:\Program Files\Spark\spark-3.5.0-bin-hadoop3


–ü–ª—é—Å –Ω—É–∂–Ω–æ –¥–æ–ø–æ–ª–Ω–∏—Ç—å –≤ —ç—Ç–æ–º –∂–µ —Ä–∞–∑–¥–µ–ª–µ Path:
- %JAVA_HOME%\bin
- %HADOOP_HOME%\bin
- %SPARK_HOME%\bin

**5. –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –≤—Å—ë –ª–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å Spark**


–î–ª—è —ç—Ç–æ–≥–æ –∑–∞—Ö–æ–¥–∏–º –≤ –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É. –ù–∞–ø—Ä–∏–º–µ—Ä, –º–æ–∂–Ω–æ –æ—Ç–∫—Ä—ã—Ç—å –Ω–æ–≤—ã–π —Ç–µ—Ä–º–∏–Ω–∞–ª –≤ VSC - powershell.
- –ø—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ª–∏ java: java -version
- –ø—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ª–∏ python: python --version
- –∑–∞–ø—É—Å–∫–∞–µ–º spark –≤—ã–∑–æ–≤–æ–º –∫–æ–º–∞–Ω–¥—ã: pyspark.
–ú–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å, –Ω–µ –ø—Ä–æ–ø–∏—Å—ã–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ. –¢–æ–≥–¥–∞ –Ω–∞–¥–æ –±—ã—Ç—å –ø–æ –∞–¥—Ä–µ—Å—É: C:\Program Files\Spark\spark-3.5.0-bin-hadoop3, –∏ –∑–∞–π—Ç–∏ –¥–∞–ª–µ–µ –≤ –ø–∞–ø–∫—É bin, –∏ –æ—Ç—Ç—É–¥–∞ –≤—ã–∑–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—É pyspark (–∏–ª–∏ .\pyspark).
- –ø—Ä–æ–≤–µ—Ä—è–µ–º –≤–µ—Ä—Å–∏—é pyspark: spark.version


## Jupyter Notebook –∏ Spark

–ù–∞–ª–∞–∂–∏–≤–∞–µ–º –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ Jupyter Notebook –∏ Spark –ø–æ —Å—Ç–∞—Ç—å–µ: [Get Started with PySpark and Jupyter Notebook in 3 Minutes](https://medium.com/sicara/get-started-pyspark-jupyter-guide-tutorial-ae2fe84f594f#:~:text=There%20are%20two%20ways%20to%20get%20PySpark%20available,Jupyter%20Notebook%20and%20load%20PySpark%20using%20findSpark%20package)


–¢–µ—Ç—Ä–∞–¥—å Jupyter Notebook: [–∑–¥–µ—Å—å](https://github.com/Malakhova-Natalya/Data_Learn/blob/main/DE-101/Module_07/Jupyter_Spark.ipynb "–∑–¥–µ—Å—å")


–ß—Ç–æ –≤–Ω—É—Ç—Ä–∏ —ç—Ç–æ–π —Ç–µ—Ç—Ä–∞–¥–∏:
![cover](https://github.com/Malakhova-Natalya/Data_Learn/blob/main/DE-101/Module_07/Jupyter_Spark.png)


–¢–µ—Ç—Ä–∞–¥—å Jupyter Notebook —Å –ø—Ä–æ–±–Ω–æ–π –∑–∞–¥–∞—á–µ–π –ø—Ä–æ M&Ms: [–∑–¥–µ—Å—å](https://github.com/Malakhova-Natalya/Data_Learn/blob/main/DE-101/Module_07/Spark_notebook.ipynb "–∑–¥–µ—Å—å")

![cover](https://github.com/Malakhova-Natalya/Data_Learn/blob/main/DE-101/Module_07/mnms_1.png)
![cover](https://github.com/Malakhova-Natalya/Data_Learn/blob/main/DE-101/Module_07/mnms_2.png)
![cover](https://github.com/Malakhova-Natalya/Data_Learn/blob/main/DE-101/Module_07/mnms_3.png)

## –ü—Ä–∞–∫—Ç–∏–∫–∞ –≤ Spark

–í –∫–∞—á–µ—Å—Ç–≤–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ –¥–≤–µ —Ç–µ—Ç—Ä–∞–¥–∏:

1. –¢–µ—Ç—Ä–∞–¥—å Jupyter Notebook "San-Francisco fire calls project": [–∑–¥–µ—Å—å](https://github.com/Malakhova-Natalya/Data_Learn/blob/main/DE-101/Module_07/Spark_fire_calls.ipynb "–∑–¥–µ—Å—å")
2. –¢–µ—Ç—Ä–∞–¥—å Jupyter Notebook "More practice (Departure delays project)": [–∑–¥–µ—Å—å](https://github.com/Malakhova-Natalya/Data_Learn/blob/main/DE-101/Module_07/Spark_practice.ipynb "–∑–¥–µ—Å—å")

